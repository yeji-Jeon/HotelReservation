var $jscomp={scope:{},findInternal:function(d,p,h){d instanceof String&&(d=String(d));for(var q=d.length,u=0;u<q;u++){var n=d[u];if(p.call(h,n,u,d))return{i:u,v:n}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,p,h){if(h.get||h.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[p]=h.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,p,h,q){if(p){h=$jscomp.global;d=d.split(".");for(q=0;q<d.length-1;q++){var u=d[q];u in h||(h[u]={});h=h[u]}d=d[d.length-1];q=h[d];p=p(q);p!=q&&null!=p&&$jscomp.defineProperty(h,d,{configurable:!0,writable:!0,value:p})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,h){return $jscomp.findInternal(this,d,h).v}},"es6-impl","es3");
(function(d){"function"===typeof define&&define.amd?define(["jquery","./grid.base"],d):"object"===typeof module&&module.exports?module.exports=function(p,h){p||(p=window);void 0===h&&(h="undefined"!==typeof window?require("jquery"):require("jquery")(p));require("./grid.base");d(h);return h}:d(jQuery)})(function(d){var p=d.jgrid,h=p.getAccessor,q=p.stripPref,u=p.jqID,n=d.fn.jqGrid,v=function(){var a=d.makeArray(arguments);a[0]="treeGrid"+a[0].charAt(0).toUpperCase()+a[0].substring(1);a.unshift("");
a.unshift("");a.unshift(this.p);return p.feedback.apply(this,a)};p.extend({setTreeNode:function(){return this.each(function(){var a=d(this),b=this.p;if(this.grid&&b.treeGrid){var c=b.treeReader.expanded_field,g=b.treeReader.leaf_field;a.off("jqGridBeforeSelectRow.setTreeNode");a.on("jqGridBeforeSelectRow.setTreeNode",function(e,k,l){if(null!=l){e=d(l.target);l=e.closest("tr.jqgrow>td");var m=l.parent(),f=function(){var d=b.data[b._index[q(b.idPrefix,k)]],e=d[c]?"collapse":"expand";d[g]||(n[e+"Row"].call(a,
d,m),n[e+"Node"].call(a,d,m))};e.is("div.treeclick")?f():b.ExpandColClick&&0<l.length&&0<e.closest("span.cell-wrapper",l).length&&f();return!0}})}})},setTreeGrid:function(){return this.each(function(){var a=this.p,b,c,g,e=[],k=["leaf_field","expanded_field","loaded"];if(a.treeGrid){a.treedatatype||d.extend(this.p,{treedatatype:a.datatype});a.subGrid=!1;a.altRows=!1;a.pgbuttons=!1;a.pginput=!1;a.gridview=!0;null===a.rowTotal&&(a.rowNum=a.maxRowNum);a.rowList=[];a.treeIcons.plus="rtl"===a.direction?
a.treeIcons.plusRtl:a.treeIcons.plusLtr;"nested"===a.treeGridModel?a.treeReader=d.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},a.treeReader):"adjacency"===a.treeGridModel&&(a.treeReader=d.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},a.treeReader));for(c in a.colModel)if(a.colModel.hasOwnProperty(c))for(g in b=a.colModel[c].name,
a.treeReader)a.treeReader.hasOwnProperty(g)&&a.treeReader[g]===b&&e.push(b);d.each(a.treeReader,function(b){var c=String(this);c&&-1===d.inArray(c,e)&&(0<=d.inArray(b,k)?a.additionalProperties.push({name:c,search:!1,convert:function(a){return!0===a||"true"===String(a).toLowerCase()||"1"===String(a)?!0:a}}):a.additionalProperties.push(c))})}})},expandRow:function(a){this.each(function(){var b=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,e=a[c.localReader.id];if(v.call(this,
"beforeExpandRow",{rowid:e,item:a})){var k=n.getNodeChildren.call(b,a);d(k).each(function(){var a=c.idPrefix+h(this,c.localReader.id);d(n.getGridRowById.call(b,a)).css("display","");this[g]&&n.expandRow.call(b,this)});v.call(this,"afterExpandRow",{rowid:e,item:a})}}})},collapseRow:function(a){this.each(function(){var b=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,e=a[c.localReader.id];if(v.call(this,"beforeCollapseRow",{rowid:e,item:a})){var k=n.getNodeChildren.call(b,
a);d(k).each(function(){var a=c.idPrefix+h(this,c.localReader.id);d(n.getGridRowById.call(b,a)).css("display","none");this[g]&&n.collapseRow.call(b,this)});v.call(this,"afterCollapseRow",{rowid:e,item:a})}}})},getRootNodes:function(){var a=[];this.each(function(){var b=this.p;if(this.grid&&b.treeGrid)switch(b.treeGridModel){case "nested":var c=b.treeReader.level_field;d(b.data).each(function(){parseInt(this[c],10)===parseInt(b.tree_root_level,10)&&a.push(this)});break;case "adjacency":var g=b.treeReader.parent_id_field;
d(b.data).each(function(){null!==this[g]&&"null"!==String(this[g]).toLowerCase()||a.push(this)})}});return a},getNodeDepth:function(a){var b=null;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":b=parseInt(a[c.treeReader.level_field],10)-parseInt(c.tree_root_level,10);break;case "adjacency":b=n.getNodeAncestors.call(d(this),a).length}});return b},getNodeParent:function(a){var b=this[0];if(!b||!b.grid||null==b.p||!b.p.treeGrid||null==a)return null;var b=
b.p,c=b.treeReader,g=a[c.parent_id_field];if("nested"===b.treeGridModel){var e=null,k=c.left_field,l=c.right_field,m=c.level_field,f=parseInt(a[k],10),r=parseInt(a[l],10),n=parseInt(a[m],10);d(b.data).each(function(){if(parseInt(this[m],10)===n-1&&parseInt(this[k],10)<f&&parseInt(this[l],10)>r)return e=this,!1});return e}if(null===g||"null"===g)return null;a=b._index[g];return void 0!==a?b.data[a]:null},getNodeChildren:function(a){var b=[];this.each(function(){var c=this.p;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":var g=
c.treeReader.left_field,e=c.treeReader.right_field,k=c.treeReader.level_field,l=parseInt(a[g],10),m=parseInt(a[e],10),f=parseInt(a[k],10);d(c.data).each(function(){parseInt(this[k],10)===f+1&&parseInt(this[g],10)>l&&parseInt(this[e],10)<m&&b.push(this)});break;case "adjacency":var r=c.treeReader.parent_id_field,n=c.localReader.id;d(c.data).each(function(){String(this[r])===String(a[n])&&b.push(this)})}});return b},getFullTreeNode:function(a){var b=[];this.each(function(){var c=this.p,g;if(this.grid&&
c.treeGrid)switch(c.treeGridModel){case "nested":var e=c.treeReader.left_field,k=c.treeReader.right_field,l=c.treeReader.level_field,m=parseInt(a[e],10),f=parseInt(a[k],10),n=parseInt(a[l],10);d(c.data).each(function(){parseInt(this[l],10)>=n&&parseInt(this[e],10)>=m&&parseInt(this[e],10)<=f&&b.push(this)});break;case "adjacency":if(a){b.push(a);var p=c.treeReader.parent_id_field,h=c.localReader.id;d(c.data).each(function(){var a;g=b.length;for(a=0;a<g;a++)if(String(b[a][h])===String(this[p])){b.push(this);
break}})}}});return b},getNodeAncestors:function(a){var b=[];this.each(function(){var c=d(this),g=n.getNodeParent;if(this.grid&&this.p.treeGrid)for(var e=g.call(c,a);e;)b.push(e),e=g.call(c,e)});return b},isVisibleNode:function(a){var b=!0;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid){var g=n.getNodeAncestors.call(d(this),a),e=c.treeReader.expanded_field;d(g).each(function(){b=b&&this[e];if(!b)return!1})}});return b},isNodeLoaded:function(a){var b;this.each(function(){var c=this.p;if(this.grid&&
c.treeGrid){var g=c.treeReader.leaf_field,c=c.treeReader.loaded;b=void 0!==a?void 0!==a[c]?a[c]:a[g]||0<n.getNodeChildren.call(d(this),a).length?!0:!1:!1}});return b},expandNode:function(a){return this.each(function(){var b=this.p;if(this.grid&&b.treeGrid){var c=b.treeReader.expanded_field,g=b.treeReader.parent_id_field,e=b.treeReader.loaded,k=b.treeReader.level_field,l=b.treeReader.left_field,m=b.treeReader.right_field;if(!a[c]){var f=h(a,b.localReader.id);if(v.call(this,"beforeExpandNode",{rowid:f,
item:a})){var r=d("#"+b.idPrefix+u(f),this.grid.bDiv)[0],p=b._index[f];"local"===b.treedatatype||n.isNodeLoaded.call(d(this),b.data[p])?(a[c]=!0,d("div.treeclick",r).removeClass(b.treeIcons.plus+" tree-plus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.minus+" tree-minus")):this.grid.hDiv.loading||(a[c]=!0,d("div.treeclick",r).removeClass(b.treeIcons.plus+" tree-plus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.minus+" tree-minus"),b.treeANode=r.rowIndex,b.datatype=
b.treedatatype,n.setGridParam.call(d(this),{postData:"nested"===b.treeGridModel?{nodeid:f,n_level:a[k],n_left:a[l],n_right:a[m]}:{nodeid:f,n_level:a[k],parentid:a[g]}}),d(this).trigger("reloadGrid"),a[e]=!0,n.setGridParam.call(d(this),{postData:"nested"===b.treeGridModel?{nodeid:"",n_level:"",n_left:"",n_right:""}:{nodeid:"",n_level:"",parentid:""}}));v.call(this,"afterExpandNode",{rowid:f,item:a})}}}})},collapseNode:function(a){return this.each(function(){var b=this.p;if(this.grid&&b.treeGrid){var c=
b.treeReader.expanded_field;if(a[c]){var g=h(a,b.localReader.id);if(v.call(this,"beforeCollapseNode",{rowid:g,item:a})){a[c]=!1;d("#"+b.idPrefix+u(g),this.grid.bDiv).find("div.treeclick").removeClass(b.treeIcons.minus+" tree-minus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.plus+" tree-plus");if(!0===b.unloadNodeOnCollapse||d.isFunction(b.unloadNodeOnCollapse)&&b.unloadNodeOnCollapse.call(this,a))a[b.treeReader.loaded]=!1,d(this).jqGrid("delTreeNode",g,!0);v.call(this,"afterCollapseNode",
{rowid:g,item:a})}}}})},SortTree:function(a,b,c,g){return this.each(function(){var e=this,k=e.p,l=d(e);if(e.grid&&k.treeGrid){var m,f,r,B=[];m=n.getRootNodes.call(l);m=p.from.call(e,m);m.orderBy(a,b,c,g);var q=m.select();m=0;for(f=q.length;m<f;m++)r=q[m],B.push(r),n.collectChildrenSortTree.call(l,B,r,a,b,c,g);d.each(B,function(a){var b=h(this,k.localReader.id);d(e.rows[a]).after(l.find(">tbody>tr#"+u(b)))})}})},collectChildrenSortTree:function(a,b,c,g,e,k){return this.each(function(){var l=d(this);
if(this.grid&&this.p.treeGrid){var m,f,r;m=n.getNodeChildren.call(l,b);m=p.from.call(this,m);m.orderBy(c,g,e,k);var h=m.select();m=0;for(f=h.length;m<f;m++)r=h[m],a.push(r),n.collectChildrenSortTree.call(l,a,r,c,g,e,k)}})},setTreeRow:function(a,b){var c=!1;this.each(function(){this.grid&&this.p.treeGrid&&(c=n.setRowData.call(d(this),a,b))});return c},delTreeNode:function(a,b){return this.each(function(){var c=this.p,g,e,k,l;k=c.localReader.id;var m,f=d(this),r=c.treeReader.left_field,h=c.treeReader.right_field;
if(this.grid&&c.treeGrid&&(m=c._index[a],void 0!==m)){g=parseInt(c.data[m][h],10);e=g-parseInt(c.data[m][r],10)+1;var q=n.getFullTreeNode.call(f,c.data[m]);if(0<q.length)for(m=0;m<q.length;m++)b&&a===q[m][k]||n.delRowData.call(f,q[m][k]);if("nested"===c.treeGridModel){k=p.from.call(this,c.data).greater(r,g,{stype:"integer"}).select();if(k.length)for(l in k)k.hasOwnProperty(l)&&(k[l][r]=parseInt(k[l][r],10)-e);k=p.from.call(this,c.data).greater(h,g,{stype:"integer"}).select();if(k.length)for(l in k)k.hasOwnProperty(l)&&
(k[l][h]=parseInt(k[l][h],10)-e)}}})},addChildNode:function(a,b,c,g){return this.each(function(){if(c){var e=this.p,k=d(this),l=n.getInd,m,f,h,q,u,v=b,C,y=e.treeReader.expanded_field,z=e.treeReader.leaf_field,H=e.treeReader.level_field,J=e.treeReader.parent_id_field,x=e.treeReader.left_field,w=e.treeReader.right_field,D=e.treeReader.loaded;void 0===g&&(g=!1);null==a&&(a=p.randId());var I=l.call(k,b);C=!1;if(void 0===b||null===b||""===b)v=b=null,m="last",q=e.tree_root_level;else{m="after";f=e._index[b];
h=e.data[f];b=h[e.localReader.id];u=l.call(k,b);q=parseInt(h[H],10)+1;var E=n.getFullTreeNode.call(k,h);if(E.length){var A,F,G;for(A=0;A<E.length;A++)G=E[A][e.localReader.id],F=l.call(k,G),F>u&&(u=F,v=G)}h[z]&&(C=!0,h[y]=!0,d(this.rows[I]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(e.treeIcons.leaf+" tree-leaf").addClass(e.treeIcons.commonIconClass).addClass(e.treeIcons.minus+" tree-minus"),e.data[f][z]=!1,h[D]=!0)}void 0===
c[y]&&(c[y]=!1);void 0===c[D]&&(c[D]=!1);c[H]=q;void 0===c[z]&&(c[z]=!0);"adjacency"===e.treeGridModel&&(c[J]=b);if("nested"===e.treeGridModel){var t;if(null!==b){l=parseInt(h[w],10);e=p.from.call(this,e.data);e=e.greaterOrEquals(w,l,{stype:"integer"});f=e.select();if(f.length)for(t in f)f.hasOwnProperty(t)&&(f[t][x]=f[t][x]>l?parseInt(f[t][x],10)+2:f[t][x],f[t][w]=f[t][w]>=l?parseInt(f[t][w],10)+2:f[t][w]);c[x]=l;c[w]=l+1}else{l=parseInt(n.getCol.call(k,w,!1,"max"),10);f=p.from.call(this,e.data).greater(x,
l,{stype:"integer"}).select();if(f.length)for(t in f)f.hasOwnProperty(t)&&(f[t][x]=parseInt(f[t][x],10)+2);f=p.from.call(this,e.data).greater(w,l,{stype:"integer"}).select();if(f.length)for(t in f)f.hasOwnProperty(t)&&(f[t][w]=parseInt(f[t][w],10)+2);c[x]=l+1;c[w]=l+2}}(null===b||n.isNodeLoaded.call(k,h)||C)&&n.addRowData.call(k,a,c,m,v);h&&!h[y]&&g&&d(this.rows[I]).find("div.treeclick").click()}})}})});
//# sourceMappingURL=grid.treegrid.map

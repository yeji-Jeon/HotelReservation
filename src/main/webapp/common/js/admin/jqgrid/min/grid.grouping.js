var $jscomp={scope:{},findInternal:function(d,r,f){d instanceof String&&(d=String(d));for(var b=d.length,g=0;g<b;g++){var k=d[g];if(r.call(f,k,g,d))return{i:g,v:k}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,r,f){if(f.get||f.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[r]=f.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,r,f,b){if(r){f=$jscomp.global;d=d.split(".");for(b=0;b<d.length-1;b++){var g=d[b];g in f||(f[g]={});f=f[g]}d=d[d.length-1];b=f[d];r=r(b);r!=b&&null!=r&&$jscomp.defineProperty(f,d,{configurable:!0,writable:!0,value:r})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,f){return $jscomp.findInternal(this,d,f).v}},"es6-impl","es3");
(function(d){"function"===typeof define&&define.amd?define(["jquery","./grid.base"],d):"object"===typeof module&&module.exports?module.exports=function(r,f){r||(r=window);void 0===f&&(f="undefined"!==typeof window?require("jquery"):require("jquery")(r));require("./grid.base");d(f);return f}:d(jQuery)})(function(d){var r=d.jgrid,f=d.fn.jqGrid;r.extend({groupingSetup:function(){return this.each(function(){var b,g;g=this.p;var k=g.colModel,a=g.groupingView,c,l,e=function(){return""};if(null===a||"object"!==
typeof a&&!d.isFunction(a))g.grouping=!1;else if(a.groupField.length){void 0===a.visibiltyOnNextGrouping&&(a.visibiltyOnNextGrouping=[]);a.lastvalues=[];a._locgr||(a.groups=[]);a.counters=[];for(b=0;b<a.groupField.length;b++)a.groupOrder[b]||(a.groupOrder[b]="asc"),a.groupText[b]||(a.groupText[b]="{0}"),"boolean"!==typeof a.groupColumnShow[b]&&(a.groupColumnShow[b]=!0),"boolean"!==typeof a.groupSummary[b]&&(a.groupSummary[b]=!1),a.groupSummaryPos[b]||(a.groupSummaryPos[b]="footer"),c=k[g.iColByName[a.groupField[b]]],
!0===a.groupColumnShow[b]?(a.visibiltyOnNextGrouping[b]=!0,null!=c&&!0===c.hidden&&f.showCol.call(d(this),a.groupField[b])):(a.visibiltyOnNextGrouping[b]=d("#"+r.jqID(g.id+"_"+a.groupField[b])).is(":visible"),null!=c&&!0!==c.hidden&&f.hideCol.call(d(this),a.groupField[b]));a.summary=[];a.hideFirstGroupCol&&(a.formatDisplayField[0]=function(a){return a});b=0;for(g=k.length;b<g;b++)c=k[b],a.hideFirstGroupCol&&!c.hidden&&a.groupField[0]===c.name&&(c.formatter=e),c.summaryType&&(l={nm:c.name,st:c.summaryType,
v:"",sr:c.summaryRound,srt:c.summaryRoundType||"round"},c.summaryDivider&&(l.sd=c.summaryDivider,l.vd=""),a.summary.push(l))}else g.grouping=!1})},groupingPrepare:function(b,g){this.each(function(){var k=this,a=k.p,c=a.groupingView,l=c.groups,e=c.counters,B=c.lastvalues,m=c.isInTheSameGroup,r=c.groupField.length,n,q,v,w,t,D,y,A,h=!1,u=f.groupingCalculations.handler,x=function(){var a,c,h;for(a=0;a<t.summary.length;a++)c=t.summary[a],h=d.isArray(c.st)?c.st[w.idx]:c.st,d.isFunction(h)?c.v=h.call(k,
c.v,c.nm,b,w):(c.v=u.call(d(k),h,c.v,c.nm,c.sr,c.srt,b),"avg"===h.toLowerCase()&&c.sd&&(c.vd=u.call(d(k),h,c.vd,c.sd,c.sr,c.srt,b)));return t.summary},H=function(b,h){if(null==b&&c.useDefaultValuesOnGrouping){var g=void 0!==a.iColByName[h]?a.colModel[a.iColByName[h]]:a.additionalProperties[a.iPropByName[h]];null!=g&&null!=g.formatter&&(null!=g.formatoptions&&void 0!==g.formatoptions.defaultValue?b=g.formatoptions.defaultValue:"string"===typeof g.formatter&&(g=d(k).jqGrid("getGridRes","formatter."+
g.formatter+".defaultValue"),void 0!==g&&(b=g)))}return b};for(n=0;n<r;n++)if(D=c.groupField[n],y=H(b[D],D),q=c.displayField[n],A=null==q?null:H(b[q],q),null==A&&(A=y),void 0!==y){v=[];for(q=0;q<=n;q++)v.push(b[c.groupField[q]]);w={idx:n,dataIndex:D,value:y,displayValue:A,startRow:g,cnt:1,keys:v,summary:[]};t={cnt:1,pos:l.length,summary:d.extend(!0,[],c.summary)};0===g?(l.push(w),B[n]=y,e[n]=t):"object"===typeof y||(d.isArray(m)&&d.isFunction(m[n])?m[n].call(k,B[n],y,n,c):B[n]===y)?h?(l.push(w),B[n]=
y,e[n]=t):(t=e[n],t.cnt+=1,l[t.pos].cnt=t.cnt):(l.push(w),B[n]=y,h=!0,e[n]=t);l[t.pos].summary=x();for(q=t.pos-1;0<=q;q--)if(l[q].idx<l[t.pos].idx){l[t.pos].parentGroupIndex=q;l[t.pos].parentGroup=l[q];break}}});return this},getGroupHeaderIndex:function(b,g){var k=this[0].p,a=g?d(g).closest("tr.jqgroup"):d("#"+r.jqID(b)),c=parseInt(a.data("jqgrouplevel"),10),k=k.id+"ghead_"+c+"_";return isNaN(c)||!a.hasClass("jqgroup")||b.length<=k.length?-1:parseInt(b.substring(k.length),10)},groupingToggle:function(b,
g){this.each(function(){var k=this.p,a=k.groupingView,c=a.minusicon,l=a.plusicon,e=g?d(g).closest("tr.jqgroup"):d("#"+r.jqID(b)),f,m,G=!0,n=!1,q=[],v=function(a){var c,d=a.length;for(c=0;c<d;c++)q.push(a[c])},w=parseInt(e.data("jqgrouplevel"),10);k.frozenColumns&&0<e.length&&(m=e[0].rowIndex,e=d(this.rows[m]),e=e.add(this.grid.fbRows[m]));f=e.find(">td>span.tree-wrap");r.hasAllClasses(f,c)?(f.removeClass(c).addClass(l),n=!0):f.removeClass(l).addClass(c);for(e=e.next();e.length;e=e.next())if(e.hasClass("jqfoot"))if(f=
parseInt(e.data("jqfootlevel"),10),n){if(f=parseInt(e.data("jqfootlevel"),10),(!a.showSummaryOnHide&&f===w||f>w)&&v(e),f<w)break}else{if((f===w||a.showSummaryOnHide&&f===w+1)&&v(e),f<=w)break}else if(e.hasClass("jqgroup"))if(f=parseInt(e.data("jqgrouplevel"),10),n){if(f<=w)break;v(e)}else{if(f<=w)break;f===w+1&&(e.find(">td>span.tree-wrap").removeClass(c).addClass(l),v(e));G=!1}else(n||G)&&v(e);d(q).css("display",n?"none":"");k.frozenColumns&&d(this).triggerHandler("jqGridResetFrozenHeights",[{header:{resizeDiv:!1,
resizedRows:{iRowStart:-1,iRowEnd:-1}},resizeFooter:!1,body:{resizeDiv:!0,resizedRows:{iRowStart:m,iRowEnd:e.length?e[0].rowIndex-1:-1}}}]);this.fixScrollOffsetAndhBoxPadding();d(this).triggerHandler("jqGridGroupingClickGroup",[b,n]);d.isFunction(k.onClickGroup)&&k.onClickGroup.call(this,b,n)});return!1},groupingRender:function(b,g){function k(a,b,g,f,k){var h=q[a],e,u="",n,p,t,A=0,x,y,B,H=!0;if(0!==b&&0!==q[a].idx)for(e=a;0<=e;e--)if(q[e].idx===q[a].idx-b){h=q[e];break}a=h.cnt;for(x=void 0===k?f:
0;x<w;x++){b="&#160;";e=v[x];for(n=0;n<h.summary.length;n++)if(p=h.summary[n],y=d.isArray(p.st)?p.st[g.idx]:p.st,B=d.isArray(e.summaryTpl)?e.summaryTpl[g.idx]:e.summaryTpl||"{0}",p.nm===e.name){"string"===typeof y&&"avg"===y.toLowerCase()&&(p.sd&&p.vd?p.v/=p.vd:p.v&&0<a&&(p.v/=a));try{p.groupCount=h.cnt,p.groupIndex=h.dataIndex,p.groupValue=h.value,t=c.formatter("",p.v,x,p)}catch(K){t=p.v}b=r.format(B,t);e.summaryFormat&&(b=e.summaryFormat.call(c,g,b,t,e,p));break}p=n=!1;void 0!==k&&H&&!e.hidden&&
(b=k,H=!1,1<f&&(n=!0,A=f-1),p=e.align,e.align="rtl"===l.direction?"right":"left",m.iconColumnName=e.name);0<A&&!e.hidden&&"&#160;"===b?(p&&(e.align=p),A--):(u+="<td role='gridcell' "+c.formatCol(x,1,"")+(n?"colspan='"+f+"'":"")+">"+b+"</td>",p&&(e.align=p))}return u}var a="",c=this[0],l=c.p,e=0,B=[],m=l.groupingView,G=d.makeArray(m.groupSummary),n=m.groupField.length,q=m.groups,v=l.colModel,w=v.length,t=l.page,D=f.getGuiStyles.call(c,"gridRow","jqgroup ui-row-"+l.direction),y=f.getGuiStyles.call(c,
"gridRow","jqfoot ui-row-"+l.direction);d.each(v,function(a,b){var c;for(c=0;c<n;c++)if(m.groupField[c]===b.name){B[c]=a;break}});G.reverse();d.each(q,function(f,h){var u,x=l.id+"ghead_"+h.idx,A=x+"_"+f,E=d.isFunction(m.groupCollapse)?m.groupCollapse.call(c,{group:h,rowid:A}):m.groupCollapse,F,z;z=0;var C,p;C=n-1===h.idx;var I=null!=h.parentGroup?h.parentGroup.collapsed:!1;p="<span style='cursor:pointer;margin-"+("rtl"===l.direction?"right:":"left:")+12*h.idx+"px;' class='"+m.commonIconClass+" "+
(E?m.plusicon:m.minusicon)+" tree-wrap' onclick=\"jQuery('#"+r.jqID(l.id).replace("\\","\\\\")+"').jqGrid('groupingToggle','"+A+"', this);return false;\"></span>";if(m._locgr&&!(h.startRow+h.cnt>(t-1)*g&&h.startRow<t*g))return!0;I&&(E=!0);void 0!==E&&(h.collapsed=E);e++;try{d.isArray(m.formatDisplayField)&&d.isFunction(m.formatDisplayField[h.idx])?(h.displayValue=m.formatDisplayField[h.idx].call(c,h.displayValue,h.value,v[B[h.idx]],h.idx,m),u=h.displayValue):u=c.formatter(A,h.displayValue,B[h.idx],
h.value)}catch(J){u=h.displayValue}a+="<tr id='"+A+"' data-jqgrouplevel='"+h.idx+"' "+(E&&I?"style='display:none;' ":"")+"role='row' class='"+D+" "+x+"'>";x=d.isFunction(m.groupText[h.idx])?m.groupText[h.idx].call(c,u,h.cnt,h.summary):r.template(m.groupText[h.idx],u,h.cnt,h.summary);"string"!==typeof x&&"number"!==typeof x&&(x=u);"header"===m.groupSummaryPos[h.idx]?(u=1,"cb"!==v[0].name&&"cb"!==v[1].name||u++,"subgrid"!==v[0].name&&"subgrid"!==v[1].name||u++,a+=k(f,0,h,u,p+"<span class='cell-wrapper'>"+
x+"</span>")):a+="<td role='gridcell' style='padding-left:"+12*h.idx+"px;' colspan='"+w+"'>"+p+x+"</td>";a+="</tr>";if(C){C=q[f+1];u=h.startRow;p=void 0!==C?C.startRow:q[f].startRow+q[f].cnt;m._locgr&&(z=(t-1)*g,z>h.startRow&&(u=z));for(;u<p&&b[u-z];u++)a+=b[u-z].join("");if("header"!==m.groupSummaryPos[h.idx]){if(void 0!==C){for(F=0;F<m.groupField.length&&C.dataIndex!==m.groupField[F];F++);e=m.groupField.length-F}for(z=0;z<e;z++)G[z]&&(a+="<tr data-jqfootlevel='"+(h.idx-z)+(E&&(0<h.idx-z||!m.showSummaryOnHide)?
"' style='display:none;'":"'")+" role='row' class='"+y+"'>",a+=k(f,z,q[h.idx-z],0),a+="</tr>");e=F}}});this.off("jqGridShowHideCol.groupingRender").on("jqGridShowHideCol.groupingRender",function(){var a=l.iColByName[m.iconColumnName],b,g,e;if(0<=d.inArray("header",m.groupSummaryPos)){for(b=0;b<v.length;b++)if(!v[b].hidden){e=b;break}if(void 0!==e&&a!==e){for(b=0;b<c.rows.length;b++)g=c.rows[b],d(g).hasClass("jqgroup")&&(d(g.cells[e]).html(g.cells[a].innerHTML),d(g.cells[a]).html("&nbsp;"));m.iconColumnName=
v[e].name}}});return a},groupingGroupBy:function(b,g){return this.each(function(){var k=this.p,a=k.groupingView,c,l;"string"===typeof b&&(b=[b]);k.grouping=!0;a._locgr=!1;void 0===a.visibiltyOnNextGrouping&&(a.visibiltyOnNextGrouping=[]);for(c=0;c<a.groupField.length;c++)l=k.colModel[k.iColByName[a.groupField[c]]],!a.groupColumnShow[c]&&a.visibiltyOnNextGrouping[c]&&null!=l&&!0===l.hidden&&f.showCol.call(d(this),a.groupField[c]);for(c=0;c<b.length;c++)a.visibiltyOnNextGrouping[c]=d(k.idSel+"_"+r.jqID(b[c])).is(":visible");
k.groupingView=d.extend(k.groupingView,g||{});a.groupField=b;d(this).trigger("reloadGrid")})},groupingRemove:function(b){return this.each(function(){var g=this.p,k=this.tBodies[0],a=g.groupingView;void 0===b&&(b=!0);g.grouping=!1;if(!0===b){for(g=0;g<a.groupField.length;g++)!a.groupColumnShow[g]&&a.visibiltyOnNextGrouping[g]&&f.showCol.call(d(this),a.groupField);d("tr.jqgroup, tr.jqfoot",k).remove();d("tr.jqgrow",k).filter(":hidden").show()}else d(this).trigger("reloadGrid")})},groupingCalculations:{handler:function(b,
d,f,a,c,l){var e={sum:function(){return parseFloat(d||0)+parseFloat(l[f]||0)},min:function(){return""===d?parseFloat(l[f]||0):Math.min(parseFloat(d),parseFloat(l[f]||0))},max:function(){return""===d?parseFloat(l[f]||0):Math.max(parseFloat(d),parseFloat(l[f]||0))},count:function(){""===d&&(d=0);return l.hasOwnProperty(f)?d+1:0},avg:function(){return e.sum()}};if(!e[b])throw"jqGrid Grouping No such method: "+b;b=e[b]();null!=a&&("fixed"===c?b=b.toFixed(a):(a=Math.pow(10,a),b=Math.round(b*a)/a));return b}}})});
//# sourceMappingURL=grid.grouping.map
